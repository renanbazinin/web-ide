"use strict";(globalThis.webpackChunk_nand2tetris_web=globalThis.webpackChunk_nand2tetris_web||[]).push([[519],{135:(e,t,s)=>{s.d(t,{Wf:()=>r});var a=s(8281);function n(e){switch(e){case"t":return[...n("tl"),...n("tr")];case"r":return[...n("tr"),...n("br")];case"b":return[...n("br"),...n("bl")];case"l":return[...n("tl"),...n("bl")];default:return[a.Hw[e]]}}function r(e="",t=""){var s;s=e,void 0!==a.Hw[s]&&(t=e,e="");const r=function(e){return a.DN[e]}(e);return n(t).reduce((e,t)=>(""===t?e.borderRadius=r:e[`border${t}Radius`]=r,e),{})}},1091:(e,t,s)=>{s.d(t,{M:()=>n});const a=s(3096).z.get();class n{frame(){this.tick(),this.finishFrame()}finishFrame(){a.frame()}_steps=1;_steps_actual=1;get steps(){return this._steps}set steps(e){this._steps=e,this._steps_actual=e}_speed=60;get speed(){return this._speed}set speed(e){this._speed=e}get running(){return this.#e}#e=!1;#t=0;#s=0;#a=async()=>{if(!this.#e)return;const e=Date.now(),t=e-this.#s;if(this.#s=e,this.#t+=t,this.#t>this.speed){let e=!1,t=Math.min(this._steps,this._steps_actual);const s=performance.now();for(;!e&&t-- >0;)e=await this.tick();const a=performance.now()-s;this._steps_actual*=8/a,this._steps_actual=Math.ceil(this._steps_actual),this.finishFrame(),e&&this.stop(),this.#t-=this.speed}requestAnimationFrame(this.#a)};start(){this.#e=!0,this.#s=Date.now()-this.speed,this.#a(),this.toggle()}stop(){this.#e=!1,this.toggle()}}},2144:(e,t,s)=>{s.d(t,{F:()=>a});const a="Loading in progress..."},2675:(e,t,s)=>{s.d(t,{K:()=>d});var a=s(1391),n=s(8878),r=s(8029),i=s(782);const l=(0,n.lazy)(()=>Promise.all([s.e(983),s.e(88),s.e(965)]).then(s.bind(s,8965))),o=({error:e})=>e?(0,i.jsxs)("details",{className:"ErrorPanel",open:!0,children:[(0,i.jsx)("summary",{role:"button",className:"secondary",children:(0,i.jsx)(a.x6,{id:"1tSpqV"})}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:null===e||void 0===e?void 0:e.message})})]}):(0,i.jsx)(i.Fragment,{}),c=({value:e,onChange:t,language:s,disabled:a=!1})=>{const[r,l]=(0,n.useState)(e);return(0,i.jsx)("textarea",{"data-testid":`editor-${s}`,disabled:a,value:r,onChange:e=>{var s;const a=null===(s=e.target)||void 0===s?void 0:s.value;l(a),t(a)}})},d=({className:e="",style:t={},disabled:s=!1,value:a,error:d,onChange:u,onCursorPositionChange:h,grammar:p,language:m,path:g,highlight:x,highlightType:f="highlight",customDecorations:v=[],dynamicHeight:j=!1,alwaysRecenter:b=!0,lineNumberTransform:y})=>{const{monaco:w}=(0,n.useContext)(r.BR);return(0,i.jsx)("div",{className:`Editor ${j?"dynamic-height":""} ${e}`,style:t,children:w.canUse&&w.wants?(0,i.jsx)(n.Suspense,{fallback:"Loading...",children:(0,i.jsx)(l,{value:a,onChange:u,onCursorPositionChange:h,path:g,language:m,error:d,disabled:s,highlight:x,highlightType:f,customDecorations:v,dynamicHeight:j,alwaysRecenter:b,lineNumberTransform:y})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c,{value:a,onChange:u,language:m,disabled:s}),(0,i.jsx)(o,{error:d})]})})}},5168:(e,t,s)=>{s.d(t,{p:()=>r,Z:()=>n});var a=s(782);const n=e=>{var t;return(0,a.jsxs)("article",{className:["panel",null!==(t=e.className)&&void 0!==t?t:"",e.isEditorPanel?"editor":""].join(" "),children:[e.header&&(0,a.jsx)("header",{children:e.header}),(0,a.jsx)("main",{children:e.children}),e.footer&&(0,a.jsx)("footer",{children:e.footer})]})},r=e=>{var t;return(0,a.jsxs)("details",{className:null!==(t=e.className)&&void 0!==t?t:"",open:e.open,style:e.style,children:[(0,a.jsx)("summary",{children:(0,a.jsx)("div",{className:"flex row align-baseline",children:e.summary})}),e.children]})}},5519:(e,t,s)=>{s.r(t),s.d(t,{Asm:()=>C,default:()=>k});var a=s(1391),n=s(7022),r=s(910),i=s(782),l=s(135);const o=({values:e=[],highlight:t=-1,onClick:s})=>(0,i.jsx)("div",{children:e.map((e,a)=>(0,i.jsx)(c,{identifier:e.name,value:e.value,highlight:a===t,onClick:()=>s?.(e.name,e.value)},a))}),c=({identifier:e,value:t,highlight:s=!1,onClick:a})=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center"},onClick:a,children:[e.length>0&&(0,i.jsx)("code",{style:{flex:"1",...(0,l.Wf)("none"),...s?{background:"var(--mark-background-color)"}:{},whiteSpace:"pre",padding:"3px"},children:e}),t.length>0&&(0,i.jsx)("code",{style:{flex:"1",textAlign:"right",padding:"3px",...(0,l.Wf)("none"),...s?{background:"var(--mark-background-color)"}:{}},children:t})]});var d=s(4666),u=s(9547),h=s(1091),p=s(8878),m=s(2675),g=s(5168),x=s(2144),f=s(7076),v=s(8330),j=s(6073),b=s(8029),y=s(3344),w=s(3499);const C=()=>{var e,t,s;const{filePicker:l}=(0,p.useContext)(b.BR),{stores:c,setTool:C}=(0,p.useContext)(y.NQ),{state:k,actions:N,dispatch:R}=c.asm,{fs:T,localFsRoot:L}=(0,p.useContext)(r.L),_=(0,p.useRef)(0),F=(0,p.useRef)(0),S=(0,p.useRef)(),[E,P]=(0,p.useState)(!1),[A,U]=(0,p.useState)(!0);(0,p.useEffect)(()=>{C("asm")},[C]),(0,p.useEffect)(()=>(S.current=new class extends h.M{async tick(){return _.current=0,F.current=0,await N.step()}reset(){N.reset()}toggle(){}},P(!0),()=>{var e;null===(e=S.current)||void 0===e||e.stop()}),[N,R]);const H=(0,p.useRef)(null),B=(0,p.useRef)(null),{setStatus:D}=(0,p.useContext)(r.L),$=(e,t)=>{const s=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(s);H.current&&(H.current.href=a,H.current.download=t,H.current.click(),URL.revokeObjectURL(a))};return(0,i.jsxs)("div",{className:"AsmPage grid "+(A?"":"hide-sym"),children:[(0,i.jsx)(g.Z,{className:"source",isEditorPanel:!0,header:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:(0,i.jsx)(a.x6,{id:"wdxz7K"})}),(0,i.jsx)("div",{className:"flex-1",children:E&&S.current&&(0,i.jsx)(n.T,{runner:S.current,disabled:void 0!=k.error,prefix:(0,i.jsx)("button",{className:"flex-0",onClick:async()=>{const e=await l.select({suffix:".asm"});D(x.F),requestAnimationFrame(async()=>{var t;await N.loadAsm(e.path),D(""),R.current({action:"setTitle",payload:null!==(t=e.path.split("/").pop())&&void 0!==t?t:""})})},"data-tooltip":"Load file","data-placement":"bottom",children:"\ud83d\udcc2"}),overrideTooltips:{step:"Translate",run:"Translate all"},speed:k.config.speed,onSpeedChange:e=>{R.current({action:"updateConfig",payload:{speed:e}}),N.setAnimate(e<=2)}})}),!L&&(0,i.jsx)("fieldset",{role:"group",children:(0,i.jsx)("button",{"data-tooltip":"Download","data-placement":"left",onClick:()=>{var e,t;return $(k.asm,null!==(e=null===(t=k.path)||void 0===t?void 0:t.split("/").pop())&&void 0!==e?e:"source.asm")},children:"\u2b07\ufe0f"})})]}),children:(0,i.jsx)(m.K,{value:k.asm,path:null!==(e=k.path)&&void 0!==e?e:"tmp.asm",error:k.error,alwaysRecenter:!1,onChange:e=>{N.setAsm(e)},onCursorPositionChange:e=>{e!=_.current&&(_.current=e,setTimeout(()=>{N.updateHighlight(e,!0)},100))},grammar:d.y0.parser,language:"asm",highlight:k.translating?k.sourceHighlight:void 0,lineNumberTransform:e=>{if(!k.translating)return"";const t=k.lineNumbers[e];return(void 0===t?"":t).toString()}})}),(0,i.jsx)(g.Z,{className:"result",isEditorPanel:!0,header:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:(0,i.jsx)(a.x6,{id:"BUAJAb"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("a",{ref:H,style:{display:"none"}}),(0,i.jsx)(v.N_,{ref:B,style:{display:"none"},to:w.Ay.cpu.href}),(0,i.jsxs)("fieldset",{role:"group",children:[(0,i.jsx)("button",{"data-tooltip":"Load in CPU Emulator","data-placement":"left",onClick:async()=>{var e;const t=await(0,u.aU)(k.result),s=new f.n9;var a;(await s.loadBytes(t),c.cpu.actions.replaceROM(s),k.path)&&(c.cpu.dispatch.current({action:"setTitle",payload:null!==(a=k.path.split("/").pop())&&void 0!==a?a:""}),c.cpu.actions.setPath(k.path),c.cpu.actions.reset());null===(e=B.current)||void 0===e||e.click()},children:"\u21a9\ufe0f"}),!L&&(0,i.jsx)("button",{"data-tooltip":"Download","data-placement":"left",onClick:()=>{var e,t,s;return $(k.result,null!==(e=null===(t=k.path)||void 0===t||null===(s=t.split("/").pop())||void 0===s?void 0:s.replace(".asm",".hack"))&&void 0!==e?e:"result.hack")},children:"\u2b07\ufe0f"})]})]})]}),children:(0,i.jsx)(m.K,{value:k.result,path:(null!==(t=k.path)&&void 0!==t?t:"tmp.asm").replace(/\.asm$/,".hack"),highlight:k.resultHighlight,disabled:!0,onChange:function(e){},onCursorPositionChange:e=>{e!=F.current&&(F.current=e,N.updateHighlight(e,!1))},grammar:void 0,language:"",alwaysRecenter:!1,lineNumberTransform:e=>(e-1).toString()})}),(0,i.jsx)(g.Z,{className:"sym",isEditorPanel:!0,header:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(a.x6,{id:"LWSJ0G"})}),(0,i.jsx)("input",{type:"checkbox",role:"switch",checked:A,onChange:()=>U(!A)})]}),children:k.translating&&A&&(0,i.jsx)(o,{values:k.symbols})}),(0,i.jsx)(g.Z,{className:"compare",header:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(a.x6,{id:"UV+b1H"}),k.compareName&&`: ${k.compareName}`]}),(0,i.jsx)("fieldset",{role:"group",children:(0,i.jsx)("button",{onClick:async()=>{const e=await l.selectAllowLocal({suffix:"hack"});if((0,j.uf)(e)){const t=await T.readFile(e.path);R.current({action:"setCmp",payload:{cmp:t,name:e.path.split("/").pop()}})}else{const t=Array.isArray(e)?e[0]:e;R.current({action:"setCmp",payload:{cmp:t.content,name:t.name}})}},children:"\ud83d\udcc2"})}),(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("fieldset",{role:"group",children:(0,i.jsx)("button",{onClick:()=>{N.compare()},children:"Compare"})})]}),children:(0,i.jsx)(m.K,{value:k.compare,path:(null!==(s=k.path)&&void 0!==s?s:"tmp.asm").replace(/\.asm$/,".cmp"),highlight:k.translating?k.resultHighlight:void 0,highlightType:k.compareError?"error":"highlight",alwaysRecenter:!1,onChange:function(e){},disabled:!0,onCursorPositionChange:e=>{e!=F.current&&(F.current=e,N.updateHighlight(e,!1))},language:"",lineNumberTransform:e=>(e-1).toString()})})]})},k=C},7022:(e,t,s)=>{s.d(t,{T:()=>i});var a=s(782),n=s(8878),r=s(9646);const i=e=>{const t=function(e){const t=(0,n.useRef)(()=>{}),{initialState:s,reducers:a,actions:i}=(0,n.useMemo)(()=>((e,t)=>{const s={running:e.running,speed:e.speed,steps:e.steps},a=e.finishFrame.bind(e);return e.finishFrame=function(){a(),t.current({action:"update"})},{initialState:s,reducers:{update(t){t.running=e.running,t.speed=e.speed,t.steps=e.steps},setSteps(t,s){t.steps=s,e.steps=s},setSpeed(t,s){t.speed=s,e.speed=s}},actions:{frame(){e.frame()},start(){e.start(),t.current({action:"update"})},stop(){e.stop(),t.current({action:"update"})},reset(){e.reset(),t.current({action:"update"})}}}})(e,t),[e,t]),[l,o]=(0,r.A)(a,s);return t.current=o,{state:l,dispatch:t.current,actions:i}}(e.runner),[s,i]=(0,r.b)(e.speed??2),l={0:[1e3,1],1:[500,1],2:[16,1],3:[16,16666],4:[16,499980]};(0,n.useEffect)(()=>{o()},[s]);const o=()=>{const[e,a]=l[s];t.dispatch({action:"setSpeed",payload:e}),t.dispatch({action:"setSteps",payload:a})},c=(0,n.useRef)(null),d=e=>{c.current?.blur()};return(0,n.useEffect)(()=>(window.addEventListener("keydown",d),window.addEventListener("keyup",d),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",d)})),(0,a.jsxs)("div",{className:"flex row wrap",children:[(0,a.jsxs)("fieldset",{role:"group",children:[e.prefix,(0,a.jsx)("button",{className:"flex-0",disabled:e.disabled,onClick:()=>t.actions.frame(),"data-tooltip":e.overrideTooltips?.step??"Step","data-placement":"bottom",children:"\u27a1\ufe0f"}),(0,a.jsx)("button",{className:"flex-0",ref:c,disabled:e.disabled,onClick:()=>t.state.running?t.actions.stop():t.actions.start(),"data-tooltip":t.state.running?e.overrideTooltips?.pause??"Pause":e.overrideTooltips?.run??"Run","data-placement":"bottom",children:t.state.running?"\u23f8":"\ufe0f\u23e9"}),(0,a.jsx)("button",{className:"flex-0",onClick:()=>{t.state.running&&t.actions.stop(),t.actions.reset()},"data-tooltip":e.overrideTooltips?.reset??"Reset","data-placement":"bottom",children:"\u23ee"})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,fontWeight:"normal"},children:[(0,a.jsx)("span",{style:{padding:"0.2rem"},children:"Slow"}),(0,a.jsx)("input",{type:"range",min:0,max:4,step:1,value:s,disabled:t.state.running,onChange:t=>{const s=Number(t.target.value);i(s),e.onSpeedChange?.(s)},style:{width:"150px",padding:"0.2rem"},"data-tooltip":"Execution speed","data-placement":"bottom"}),(0,a.jsx)("span",{style:{padding:"0.2rem"},children:"Fast"})]}),e.children]})}},8281:(e,t,s)=>{s.d(t,{DN:()=>a,Hw:()=>n,UL:()=>r});const a={none:"0px",sm:"0.125rem","":"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},n={"":"",t:"Top",r:"Right",l:"Left",b:"Bottom",tl:"TopLeft",tr:"TopRight",bl:"BottomLeft",br:"BottomRight"},r={"1/4":"25%","1/2":"50%","3/4":"75%",full:"100%"}}}]);